# –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Easypanel

–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é Telegram –±–æ—Ç–∞ –≤ Easypanel.

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –ê–∫–∫–∞—É–Ω—Ç –≤ Easypanel
- GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: https://github.com/Huzali63/tg-analys
- Telegram Bot Token
- OpenAI API Key (–∏–ª–∏ OpenRouter/AgentRouter)

## üöÄ –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ Easypanel

1. –í–æ–π–¥–∏—Ç–µ –≤ Easypanel
2. –ù–∞–∂–º–∏—Ç–µ **"Create Project"**
3. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: `telegram-bot`

## üì¶ –®–∞–≥ 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤

### 2.1 PostgreSQL Database

1. –ù–∞–∂–º–∏—Ç–µ **"Add Service"** ‚Üí **"Database"** ‚Üí **"PostgreSQL"**
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
   - **Service Name**: `postgres`
   - **Database Name**: `telegram_bot`
   - **Username**: `telegram_user`
   - **Password**: `possword63!` (–∏–ª–∏ –≤–∞—à –ø–∞—Ä–æ–ª—å)
3. –ù–∞–∂–º–∏—Ç–µ **"Create"**
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–ø—É—Å–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### 2.2 Whisper ASR Server

1. –ù–∞–∂–º–∏—Ç–µ **"Add Service"** ‚Üí **"App"** ‚Üí **"Docker"**
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
   - **Service Name**: `whisper`
   - **Docker Image**: `onerahmet/openai-whisper-asr-webservice:latest`
   - **Port**: `9000`
   - **Environment Variables**:
     ```
     ASR_MODEL=base
     ASR_ENGINE=openai_whisper
     ```
3. –ù–∞–∂–º–∏—Ç–µ **"Create"**
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞

### 2.3 Telegram Bot

1. –ù–∞–∂–º–∏—Ç–µ **"Add Service"** ‚Üí **"App"** ‚Üí **"GitHub"**
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   - **Repository**: `Huzali63/tg-analys`
   - **Branch**: `master`
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±–æ—Ä–∫–∏:
   - **Build Method**: `Dockerfile`
   - **Dockerfile Path**: `./Dockerfile`
4. **Environment Variables** (–≤–∞–∂–Ω–æ!):
   ```env
   TELEGRAM_BOT_TOKEN=your_bot_token_here
   AI_PROVIDER=openai
   OPENAI_API_KEY=your_openai_api_key_here
   WHISPER_API_URL=http://whisper:9000
   DATABASE_URL=postgresql://telegram_user:your_password@postgres:5432/telegram_bot
   ADMIN_USER_IDS=your_telegram_id
   ```
5. –ù–∞–∂–º–∏—Ç–µ **"Create"**

## üîó –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–∏ (–≤–∞–∂–Ω–æ!)

Easypanel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å–µ—Ç—å –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ –æ–¥–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ.

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤ –æ–¥–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ:**
- `postgres`
- `whisper`
- `telegram-bot` (–∏–ª–∏ –∫–∞–∫ –≤—ã –Ω–∞–∑–≤–∞–ª–∏)

–û–Ω–∏ —Å–º–æ–≥—É—Ç –æ–±—â–∞—Ç—å—Å—è –º–µ–∂–¥—É —Å–æ–±–æ–π –ø–æ –∏–º–µ–Ω–∞–º —Å–µ—Ä–≤–∏—Å–æ–≤:
- `postgres:5432`
- `whisper:9000`

## ‚úÖ –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### 4.1 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–∏—Å `telegram-bot`
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"Logs"**
3. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
   ```
   Starting bot...
   Database connected
   Initialized OpenAI client
   ```

### 4.2 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Whisper

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–∏—Å `whisper`
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"Logs"**
3. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `Uvicorn running on http://0.0.0.0:9000`

### 4.3 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ PostgreSQL

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–∏—Å `postgres`
2. –°—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **"Running"**

## üß™ –®–∞–≥ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞

1. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
3. –í—ã –¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
5. –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –µ–≥–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞—Ç—å

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

Easypanel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç –±–æ—Ç–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ GitHub:

1. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥
2. –°–¥–µ–ª–∞–π—Ç–µ commit –∏ push –≤ GitHub
3. Easypanel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–µ—Ç –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç –±–æ—Ç–∞

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–∏—Å –±–æ—Ç–∞
2. –ù–∞–∂–º–∏—Ç–µ **"Rebuild"**

## üîß –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

### –ù–∞ OpenRouter (–¥–µ—à–µ–≤–ª–µ)

1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–∏—Å–∞ –±–æ—Ç–∞
2. –ò–∑–º–µ–Ω–∏—Ç–µ Environment Variables:
   ```env
   AI_PROVIDER=openrouter
   OPENROUTER_API_KEY=your_openrouter_api_key
   OPENROUTER_MODEL=anthropic/claude-3.5-sonnet
   ```
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å

### –ù–∞ AgentRouter (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä)

1. –ò–∑–º–µ–Ω–∏—Ç–µ Environment Variables:
   ```env
   AI_PROVIDER=agentrouter
   AGENTROUTER_API_KEY=your_agentrouter_api_key
   ```
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å

## üêõ Troubleshooting

### –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞**: –û—à–∏–±–∫–∞ –≤ –ª–æ–≥–∞—Ö `TELEGRAM_BOT_TOKEN is not set`

**–†–µ—à–µ–Ω–∏–µ**: 
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Environment Variables
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å

---

**–ü—Ä–æ–±–ª–µ–º–∞**: –û—à–∏–±–∫–∞ `Database connection failed`

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤ –æ–¥–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ

---

**–ü—Ä–æ–±–ª–µ–º–∞**: –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Whisper —Å–µ—Ä–≤–∏—Å–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `WHISPER_API_URL=http://whisper:9000`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Whisper —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω

---

**–ü—Ä–æ–±–ª–µ–º–∞**: AI –∞–Ω–∞–ª–∏–∑ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API –∫–ª—é—á–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–µ OpenAI/OpenRouter
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –æ—à–∏–±–∫–∏

### –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ

**–†–µ—à–µ–Ω–∏–µ**:
1. –£–≤–µ–ª–∏—á—å—Ç–µ —Ä–µ—Å—É—Ä—Å—ã –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Easypanel
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –ª–µ–≥–∫—É—é –º–æ–¥–µ–ª—å Whisper (`ASR_MODEL=tiny`)
3. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—É—é AI –º–æ–¥–µ–ª—å

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL —á–µ—Ä–µ–∑ Easypanel
2. –û—á–∏—Å—Ç–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
   ```sql
   DELETE FROM messages WHERE created_at < NOW() - INTERVAL '30 days';
   ```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –í Easypanel –æ—Ç–∫—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–∏—Å ‚Üí –≤–∫–ª–∞–¥–∫–∞ "Logs"
# –ò–ª–∏ —á–µ—Ä–µ–∑ CLI:
easypanel logs telegram-bot --tail 100
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Easypanel
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"Metrics"**
3. –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ CPU, RAM, Network

### –†–∞—Å—Ö–æ–¥—ã –Ω–∞ AI

- **OpenAI**: https://platform.openai.com/usage
- **OpenRouter**: https://openrouter.ai/activity
- **AgentRouter**: https://agentrouter.ai/dashboard

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ .env —Ñ–∞–π–ª** –≤ GitHub (–æ–Ω –≤ .gitignore)
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏** –¥–ª—è PostgreSQL
3. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø** –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (—Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∞)
4. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ** –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
5. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Ä–∞—Å—Ö–æ–¥—ã** –Ω–∞ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

## üìù –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞
```
Easypanel ‚Üí –°–µ—Ä–≤–∏—Å ‚Üí Restart
```

### –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```
Easypanel ‚Üí –°–µ—Ä–≤–∏—Å ‚Üí Rebuild
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
```
Easypanel ‚Üí PostgreSQL ‚Üí Connect
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
```
Easypanel ‚Üí –°–µ—Ä–≤–∏—Å ‚Üí Environment
```

## üéâ –ì–æ—Ç–æ–≤–æ!

–í–∞—à Telegram –±–æ—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç!

**–°—Å—ã–ª–∫–∏:**
- GitHub: https://github.com/Huzali63/tg-analys
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [README.md](README.md)
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ AI: [AI_PROVIDERS.md](AI_PROVIDERS.md)

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞:**
- GitHub Issues: https://github.com/Huzali63/tg-analys/issues
